<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Keyboard Arena</title>
<!--    <script src="/js/FindId.js"></script>-->
</head>
<body>
<header>
    <h1>Keyboard Arena</h1>
</header>
<main>

</main>
<div>
    <h2>아이디 찾기</h2>
    회원가입 시 입력하신 이메일로 아이디를 보내드립니다.
    <form id="findIdForm" action="/user/find/id" method="POST">
        <label for="email">이메일 입력</label>
        <input type="email" id="email" name="email" required>
        <button type="submit">이메일 발송</button>
    </form>
</div>
<script>
    const findIdForm = document.getElementById("findIdForm");
    findIdForm.addEventListener("submit", (e) => {
        e.preventDefault();
        sendEmail();
    })

    function sendEmail() {
        var formData = new FormData();
        formData.append("email", document.getElementById("email").value);

        fetch('/user/find/id', {
            method: 'POST',
            body: formData
        })
            .then(response => {
                if (response.ok) {
                    return response;
                } else {
                    throw new Error('아이디 찾기에 실패했습니다.');
                }
            })
            .then(data => {
                alert("이메일이 발송되었습니다.");
            })
            .catch(error => {
                console.log('Error: ', error);
                alert('확인할 수 없는 이메일입니다.')
            });
    }
</script>
</body>
</html>